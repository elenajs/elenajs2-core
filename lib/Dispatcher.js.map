{"version":3,"sources":["Dispatcher.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;;;;;;;;;AACb,IAAI,cAAc,GAAG,OAAO,CAAC,qBAAqB,CAAC;IAC/C,eAAe,GAAG,OAAO,CAAC,6BAA6B,CAAC;IACxD,YAAY,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC;;IAE5C,UAAU;cAAV,UAAU;;iBAAV,UAAU;;aACF,eAAG;AACT,mBAAO,IAAI,CAAC,OAAO,CAAC;SACvB;;;AAGU,aANT,UAAU,GAME;8BANZ,UAAU;;AAOR,mCAPF,UAAU,6CAOA;AACR,YAAI,CAAC,YAAY,GAAG,EAAE,CAAC;KAC1B;;iBATC,UAAU;;eAeE,wBAAC,WAAW,EAAE;AACxB,cAAE,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC,OAAO,CAAC,CAAA,UAAU,UAAU,EAAE;AACjD,0BAAU,CAAC,OAAO,GAAG,IAAI,CAAC;AAC1B,oBAAI,CAAC,YAAY,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aACtC,CAAA,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;SACjB;;;eAEO,oBAAG;AACP,gBAAI,IAAI,GAAG,YAAY,CAAC;AACxB,gCAAkB,IAAI,OAAI;SAC7B;;;eAES,oBAAC,cAAc,EAAE;AACvB,mBAAO,KAAK,CAAC;SAChB;;;eAEc,yBAAC,cAAc,EAAE;AAC5B,gBAAI,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAClC,UAAU,UAAU,EAAE;AAClB,uBAAO,OAAO,CAAC,OAAO,CAAC;AACnB,wBAAI,EAAE,cAAU,OAAO,EAAE;AACrB,+BAAO,OAAO,CAAC,UAAU,CAAC,UAAU,CAAC,cAAc,CAAC,CAAC,CAAC;qBACzD;iBACJ,CAAC,CAAC,IAAI,CAAC,UAAU,IAAI,EAAE;AACpB,2BAAO,IAAI,IAAI,UAAU,IAAI,IAAI,CAAC;iBACrC,CAAC,CAAC;aACN,CACJ,CAAC;AACF,mBAAO,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,CAAA,UAAU,MAAM,EAAE;AACnD,oBAAI,cAAc,GAAG,MAAM,CAAC,IAAI,CAAC,UAAU,UAAU,EAAE;AAC/C,2BAAO,UAAU,KAAK,IAAI,CAAC;iBAC9B,CAAC,IAAI,IAAI,CAAC;AACf,uBAAO,cAAc,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC;aACjD,CAAA,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;SAEjB;;;eAEM,iBAAC,cAAc,EAAE;AACpB,gBAAI,IAAI,GAAG,IAAI,CAAC;AAChB,mBAAO,cAAc,CAAC,cAAc,EAAE,CAAC,IAAI,CAAC,YAAY;AACpD,uBAAO,OAAO,CAAC,OAAO,CAAC;AACnB,wBAAI,EAAE,cAAU,OAAO,EAAE;AACrB,+BAAO,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC,CAAA;qBAC9C;iBACJ,CAAC,CAAA;aACL,CAAC,CAAC;SACN;;;eAEK,gBAAC,cAAc,EAAE;AACnB,kBAAM,IAAI,eAAe,CAAC,GAAG,CAAC,CAAC;SAClC;;;aAtDc,eAAG;AACd,mBAAO,IAAI,CAAC,YAAY,CAAC;SAC5B;;;WAbC,UAAU;GAAS,YAAY;;AAoErC,MAAM,CAAC,OAAO,GAAG,UAAU,CAAC","file":"Dispatcher.js","sourcesContent":["\"use strict\";\nlet RequestContext = require('./RequestContext.js'),\n    HttpStatusError = require('./errors/HttpStatusError.js'),\n    EventEmitter = require('events').EventEmitter;\n\nclass Dispatcher extends EventEmitter {\n    get parent() {\n        return this._parent;\n    }\n\n\n    constructor() {\n        super();\n        this._dispatchers = [];\n    }\n\n    get dispatchers() {\n        return this._dispatchers;\n    }\n\n    addDispatchers(dispatchers) {\n        [].concat(dispatchers).forEach(function (dispatcher) {\n            dispatcher._parent = this;\n            this._dispatchers.push(dispatcher);\n        }.bind(this));\n    }\n\n    toString() {\n        let name = 'Dispatcher';\n        return `[object ${name}]`;\n    }\n\n    isEligible(requestContext) {\n        return false;\n    }\n\n    _processRequest(requestContext) {\n        let dispatchers = this.dispatchers.map(\n            function (dispatcher) {\n                return Promise.resolve({\n                    then: function (resolve) {\n                        return resolve(dispatcher.isEligible(requestContext));\n                    }\n                }).then(function (data) {\n                    return data && dispatcher || null;\n                });\n            }\n        );\n        return Promise.all(dispatchers).then(function (values) {\n            var currDispatcher = values.find(function (dispatcher) {\n                    return dispatcher !== null;\n                }) || this;\n            return currDispatcher._render(requestContext);\n        }.bind(this));\n\n    }\n\n    _render(requestContext) {\n        let self = this;\n        return requestContext.handleResponse().then(function () {\n            return Promise.resolve({\n                then: function (resolve) {\n                    return resolve(self.render(requestContext))\n                }\n            })\n        });\n    }\n\n    render(requestContext) {\n        throw new HttpStatusError(501);\n    }\n\n}\nmodule.exports = Dispatcher;"],"sourceRoot":"/source/"}